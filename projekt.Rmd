---
title: "Valute in devizni tečaji"
author: "Ana Golob"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---
## Poročilo pri predmetu Analiza podatkov s programom R

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

***

```{r uvoz, echo=FALSE, message=FALSE, warning=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Podatke smo, v obliki HTML, pridobili iz spletnih strani:

* http://www.xe.com/currencytables/?from=USD&date= (datumi so različni),
* https://en.wikipedia.org/wiki/List_of_circulating_currencies,
* https://en.wikipedia.org/wiki/Developing_country.

Zajeti podatki popisujejo gibanje valutnih tečajev za nakup 1 USD za vse svetovna valute od začetka leta 1998 do začetka leta 2018. Višine tečajev so bile zabeležene vsak 1. dan v mesecu.

Poleg valutnih tečajev smo zajeli tudi podatke o tem katere valute uporabljajo posamezne države. Valute smo tudi razdelili v 3 skupine: 

1. Valute v katerih se največ trguje
2. Valute držav v razvoju
3. Preostale valute

Na ta način smo želeli opazovati ali so valute znotraj posamezne skupine bolj korelirane. Države smo uvrskili v skupino držav v razvoju glede na seznam, ki je bil določen po "International Monetary Fund's World Economic Outlook Report" aprila 2015.
***

# Analiza in vizualizacija podatkov
Valute predstavljajo denarno enoto neke države v kateri velja za zakonito plačilni sredstvo in se porabljajo kot sredstvo menjave vrednosti.

Danes za vrednost valut in tudi za tečaje oz. razmerja med različnimi denarnimi valutami skrbijo centralne banke, ki se ukvarjajo s fiskalnimi politikami države in z uravnavanjem, prilagajanjem in tudi opazovanjem raznih finančnih mehanizmov. Na gibanje vrednosti valut vplivajo različni ekonomski, državni in poslovni parametri, ki vplivajo tudi na spreminanje povpraševanja po valutah.

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
source("analiza/analiza.r", encoding = "UTF-8")
```
V analizi bomo obravnavali preko 165 različnih valut s katerimi se trenutno lahko trguje v posameznih državah sveta. Na grafu spodaj si najprej oglejmo mednarodno razširjene valute, torej tiste, ki se uporavljajo v več kot zgolj eni sami državi. 

```{r graf1, echo=FALSE, message=FALSE, warning=FALSE}
graf1 <- plot_ly() %>%
  add_trace(data=pogoste.valute, x= ~vars, y=~n, name= ~ime, type = 'bar') %>%
  layout(title = 'Valute, ki se uporabljajo v več kot 1 državi', 
       xaxis = list(title = "Valute", tickangle = 45),
       yaxis = list (title = "Šrevilo držav v katerih se uporabljajo")
  )
graf1 
```

Pri tem je na prvem mestu Euro, kar ni presenetljivo, saj je valuta že v zasnovi mednarodna, zasnovana za poenotenje valute znotraj Europske unije. Podobno velja za valuto XCD - Vzhodnokaribski dolar, ki je valuta osmih držav Organizacije vzhodnokaribskih držav. Ter valuti zahodnoafriški (XOF) oz. srednjeafriški frank (XAF).

Na zgornjem grafu prav tako lahko opazimo vseh sedem valut, ki smo jih uvrstili v skupino največjih. 

```{r zemljevid1, echo=FALSE,out.width = '100%',height=40000, message=FALSE, warning=FALSE, fig.align='center', fig.cap=''}
valute.svet <- ggplot() + geom_polygon(data = valute.po.svetu,
                                       aes(x=long, y = lat, group = group,fill=valuta)) + coord_fixed(1.3) +
  theme(legend.text = element_text(size=3), legend.key.size =  unit(0.09, "in")) +
  ggtitle("Nacionalne valute držav") +
  geom_text(data= izpisi.centri,
            aes(x = x, y = y, label = valuta),
            alpha = 1,
            color = "black",
            size = 1)
valute.svet
```
Zgornji zemljevid prikazuje katere valute se uporabljajo v posameznih državah.  Za države, v katerih se uporablja večje število valut, je na zemljevidu označena zgolj ena sama. Zato dodajamo že spodnjo preglednico, ki izpostavlja omenjene države.

```{r tabela, echo=FALSE, out.width = '100%', message=FALSE, warning=FALSE, fig.align='center', fig.cap=''}
drzave.z.vec.valutami
```
Na zgornjem seznamu je zelo zanimiva država Zimbabve s kar osmimi različnimi valutami. Večina valut je v Zimbabve dovoljena za trgovalne namene, ker veliko trgujejo s Kitajsko in drugimi sosednjimi državami, imjo večje število valut.
Zimbabve je včasih imelo svojo državno valuto Zimbabvijski dolar (ZWD). Vendar je med letoma 2000 in 2009 po veliki inflaciji prišlo do zloma njihove nacionalne valute. Kot posledica so leta 2009 začeli dovoljevati tudi trgovanje z Ameriškimi dolarji v katerih se danes največ trguje.

Pri drugih državah je večje število valut posledica različnih dejavnikov. Opaziti je zgodovinski vpliv, vpliv povezovanja med različnimi državami. Poleg tega pa je na sesznamu kar nekaj manjšik otoških držav, ki se preživjlajo s turizmom.

Spodja amplikacija želi zajeti dinamiko gibanja deviznih tečajov in omogočiti opazovanje koreliranosti med gibanji vrednosti različnih valut.
```{r graf2, echo=FALSE, message=FALSE, warning=FALSE}
gibanjaTecajev <- ggplot(tecajiSPovprecjem, aes(x= povprecje, y= tecaj, frame = datum, color=kratica)) +
  ggtitle("Gibanje valutnih tečajev v času") +
  xlab("Povprečna višina tečaja") +
  ylab("Visina tecaja glede na čas") +
  theme(legend.position="none") +
  geom_point() +
  geom_text(data=tecajiSPovprecjem,
            aes(x= povprecje, y= tecaj, label=kratica),
            size = 1)

gibanjaTecajev
#gg_animate(gibanjaTecajev)
```
***

```{r shiny, echo = FALSE, warning=FALSE}
shinyAppDir("shiny", options=list(width="100%", height=800))
```
